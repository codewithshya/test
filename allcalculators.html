<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Futuristic AI Calculator</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.6.0/css/all.min.css" integrity="sha512-Kc323vGBEqzTmouAECnVceyQqyqdsSiqLQISBL29aUW4U/M7pSPA/gEUZQqv1cwx4OnYxTxve5UMg5GT6L4JJg==" crossorigin="anonymous" referrerpolicy="no-referrer" />
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">

    <style>
        body {
            /* background: linear-gradient(135deg, #6B1F06, #AE6E59, #c4c051, #e29059, #6D230A); border-radius: 0 0 15px 15px; box-shadow: 0px 10px 30px rgba(0,0,0,0.3);            color: white; */
            font-family: Arial, sans-serif;
            display: flex;
            justify-content: center;
            align-items: center;
            height: 100vh;
            flex-direction: column;
            
        }
        .calculator {
            /* background: rgba(255, 255, 255, 0.1); */
            padding: 20px;
            border-radius: 10px;
            box-shadow: 0px 0px 15px cyan;
            text-align: center;
            /* transition: transform 0.3s; */
        /* }
        .calculator:hover {
            transform: scale(1.1); */
        }
        input {
            width: 100%;
            height: 200px;
            text-align: right;
            font-size: 1.5em;
        
            background: black;
            color: cyan;
            border: none;
            outline: none;
            color:aliceblue;
        }
        .buttons {
            margin-top: 10px;
            display: grid;
            grid-template-columns: repeat(4, 1fr);
            gap: 10px;
        }
        button {
            padding: 15px;
            font-size: 1.2em;
            cursor: pointer;
            background: rgba(2, 63, 1, 0.2);
            border: none;
            border-radius: 5px;
            transition: 0.3s;
            border-radius: 50px;
            color: aliceblue;
            font-size: 1.8em;

        }
        button:hover {
            background: rgb(12, 234, 4);
            color: black;
        }
        .voice-button {
            margin-top: 10px;
            padding: 10px;
            background: red;
            color: white;
            cursor: pointer;
        }
        .temp-converter {
            display: flex;
            gap: 10px;
            margin-top: 10px;
        }
        select {
            padding: 10px;
            font-size: 1em;
            background: black;
            color: cyan;
            border: 1px solid cyan;
        }




        /* BP checkup */

        .calculator1 {
            background: rgba(255, 255, 255, 0.1);
            padding: 20px;
            border-radius: 10px;
            box-shadow: 0px 0px 15px cyan;
            max-width: 100%px;
            margin: auto;
        }
        .bp-btn {
            margin-top: 10px;
            padding: 10px;
            background: red;
            color: white;
            cursor: pointer;
            border: none;
            border-radius: 5px;
            font-size: 1.2em;
        }
        video {
            width: 300px;
            height: auto;
            border: 3px solid cyan;
            border-radius: 10px;
            margin-top: 20px;
        }
        #bpResult {
            margin-top: 20px;
            font-size: 1.5em;
            color: cyan;
        }

        
    </style>
</head>
<body>
    <div class="calculator" style="margin-top: 2000px;">
        <h1 style="text-align: center;"><i class="fa-duotone fa-solid fa-calculator"></i> <b><u>Futuristic Calculator</u></b></h1>

        <table table table-bordered style="padding: 10px;">
        <input type="text" id="display" readonly>
        <div class="buttons">
            <button onclick="appendValue('7')">7</button>
            <button onclick="appendValue('8')">8</button>
            <button onclick="appendValue('9')">9</button>
            <button onclick="appendValue('+')">+</button>
            <button onclick="appendValue('4')">4</button>
            <button onclick="appendValue('5')">5</button>
            <button onclick="appendValue('6')">6</button>
            <button onclick="appendValue('-')">-</button>
            <button onclick="appendValue('1')">1</button>
            <button onclick="appendValue('2')">2</button>
            <button onclick="appendValue('3')">3</button>
            <button onclick="appendValue('*')">*</button>
            <button onclick="appendValue('0')">0</button>
            <button onclick="appendValue('.')">.</button>
            <button onclick="calculate()">=</button>
            <button onclick="appendValue('/')">/</button>
            <button onclick="clearDisplay()" style="background-color: blue; color: red;">C</button>
            <button onclick="appendValue('Math.sin(')">sin</button>
            <button onclick="appendValue('Math.cos(')">cos</button>
            <button onclick="appendValue('Math.log(')">log</button>
            <button onclick="appendValue('Math.sqrt(')">√</button>
            <button onclick="appendValue('(')">(</button>
            <button onclick="appendValue(')')">)</button>
            <button onclick="appendValue('{')">{</button>
            <button onclick="appendValue('}')">}</button>
            <button onclick="appendValue('[')">[</button>
            <button onclick="appendValue(']')">]</button>
            <button onclick="backspace()" style="background-color: #8e2907;">x</button>
        </div>
        <div class="temp-converter">
            <input type="number" id="tempInput" placeholder="Enter Temperature">
            <select id="fromUnit">
                <option value="C">Celsius (°C)</option>
                <option value="F">Fahrenheit (°F)</option>
                <option value="K">Kelvin (K)</option>
            </select>
            <select id="toUnit">
                <option value="C">Celsius (°C)</option>
                <option value="F">Fahrenheit (°F)</option>
                <option value="K">Kelvin (K)</option>
            </select>
            <button onclick="convertTemperature()" style="background-color: #693715; color: aqua;"> Convert</button>
        </div>
    </div>
    <button class="voice-button" onclick="startVoiceCommand()" style="margin-top: 25px;"><i class="fa-solid fa-microphone"></i> Voice Command</button>
    

    <!--  -->

    <div class="container" style="margin-top: 100px;">
        <!-- <h1 style="margin-top: 50px; text-align: center;">Futuristic  Calculator</h1> -->
        
        <!-- BMI Calculator -->
        <div class="calculator">
            <center><h2>BMI Calculator</h2>
            </center>
            <input type="number" id="height" placeholder="Height (cm)">
            <input type="number" id="weight" placeholder="Weight (kg)">
            <button onclick="calculateBMI()" class="btn btn-success text-info" style="margin-top: 25px; width: 100%; border-radius: 50px; height: 50px; font-size: 1.8em;">Calculate BMI</button>
            <p id="bmiResult"></p>
        </div>
        
        <!-- BP Checker -->
        <div class="calculator1" style="margin-top: 50px;">
            <h2>Blood Pressure Checkup</h2>

            <div class="calculator1">
                <h3>BP & Pulse Rate Detection</h3>
                <button onclick="startBPPulseDetection()" class="bp-btn">🩺 Start BP Check</button>
                <p id="bpResult">Waiting for Detection...</p>
            </div>
        
            <video id="webcam" style="width: 100%;" autoplay></video>
        </div>
    </table>
    </div>

    <script>
        function appendValue(value) {
            document.getElementById("display").value += value;
        }
        function clearDisplay() {
            document.getElementById("display").value = "";
        }
        function backspace() {
            let display = document.getElementById("display");
            display.value = display.value.slice(0, -1);
        }
        function calculate() {
            try {
                let expression = document.getElementById("display").value;

                // Curly & Square Brackets ko normal Parentheses me convert karna
                expression = expression.replace(/\{/g, "(").replace(/\}/g, ")");
                expression = expression.replace(/\[/g, "(").replace(/\]/g, ")");

                let result = eval(expression);
                document.getElementById("display").value = result;
            } catch (error) {
                document.getElementById("display").value = "Error";
            }
        }


         function calculateBMI() {
        let height = parseFloat(document.getElementById("height").value);
        let weight = parseFloat(document.getElementById("weight").value);

        if (isNaN(height) || isNaN(weight) || height <= 0 || weight <= 0) {
            document.getElementById("bmiResult").innerText = "Invalid Input!";
            return;
        }

        let heightInMeters = height / 100; // cm ko meters me convert karna
        let bmi = (weight / (heightInMeters * heightInMeters)).toFixed(2); // BMI calculate aur round off karna

        let category = "";
        if (bmi < 18.5) category = "Underweight";
        else if (bmi >= 18.5 && bmi < 24.9) category = "Normal weight";
        else if (bmi >= 25 && bmi < 29.9) category = "Overweight";
        else category = "Obese";

        document.getElementById("bmiResult").innerText = `Your BMI: ${bmi} (${category})`;

        // 🗣️ Voice Output
        speakResult(`Your BMI is ${bmi}, which is classified as ${category}`);
    }



// 🎙️ Universal Voice Command Function
// 🎙️ Universal Voice Command Function
function startVoiceCommand() {
    let recognition = new (window.SpeechRecognition || window.webkitSpeechRecognition)();
    recognition.lang = "en-US";

    recognition.onresult = function(event) {
        let command = event.results[0][0].transcript.toLowerCase();
        document.getElementById("display").value = command;
        console.log("Recognized Command:", command); // Debugging ke liye

        // ✅ Blood Pressure Detection Fix
        if (command.includes("bmi")) {
            calculateBMI();
        } 
        else if (command.includes("temperature")) {
            convertTemperature();
        } 
        else if (command.includes("bp") || 
                 command.includes("blood pressure") || 
                 command.includes("check blood pressure") || 
                 command.includes("measure blood pressure") || 
                 command.includes("check bp") || 
                 command.includes("blood pressure check")) {
            
            console.log("BP Checkup Command Detected!"); // Debugging ke liye
            if (typeof startBPPulseDetection === "function") {
                startBPPulseDetection();
            } else {
                console.error("Error: startBPPulseDetection() function not found!");
                speakResult("Blood pressure detection is not available.");
            }
        } 
        else {
            try {
                // ✅ Expression Replacement
                let expression = command.replace(/\bplus\b/g, "+")
                                        .replace(/\bminus\b/g, "-")
                                        .replace(/\bmultiply\b/g, "*")
                                        .replace(/\bdivide\b/g, "/");

                // ✅ Safe Evaluation of Expression
                let result = eval(expression);
                document.getElementById("display").value = result;

                // ✅ Fixed Speak Function
                speakResult(`The result is ${result}`);
            } catch (error) {
                document.getElementById("display").value = "Error";
                speakResult("Invalid Expression");
            }
        }
    };

    recognition.onerror = function(event) {
        console.error("Speech Recognition Error: ", event.error);
        speakResult("Sorry, I couldn't understand that.");
    };

    recognition.start();
}

// 🔊 Speak Result Function
function speakResult(result) {
    let speech = new SpeechSynthesisUtterance(result);
    speech.lang = "en-US";
    window.speechSynthesis.speak(speech);
}





        function convertTemperature() {
            let inputValue = parseFloat(document.getElementById("tempInput").value);
            let fromUnit = document.getElementById("fromUnit").value;
            let toUnit = document.getElementById("toUnit").value;
            let result = "";

            if (isNaN(inputValue)) {
                document.getElementById("display").value = "Invalid Input";
                speakResult("Invalid temperature input");
                return;
            }

            // Celsius to other conversions
            if (fromUnit === "C" && toUnit === "F") {
                result = (inputValue * 9/5) + 32 + "°F";
            } else if (fromUnit === "C" && toUnit === "K") {
                result = (inputValue + 273.15) + "K";
            } else if (fromUnit === "C" && toUnit === "C") {
                result = inputValue + "°C";
            }

            // Fahrenheit to other conversions
            if (fromUnit === "F" && toUnit === "C") {
                result = ((inputValue - 32) * 5/9).toFixed(2) + "°C";
            } else if (fromUnit === "F" && toUnit === "K") {
                result = (((inputValue - 32) * 5/9) + 273.15).toFixed(2) + "K";
            } else if (fromUnit === "F" && toUnit === "F") {
                result = inputValue + "°F";
            }

            // Kelvin to other conversions
            if (fromUnit === "K" && toUnit === "C") {
                result = (inputValue - 273.15).toFixed(2) + "°C";
            } else if (fromUnit === "K" && toUnit === "F") {
                result = (((inputValue - 273.15) * 9/5) + 32).toFixed(2) + "°F";
            } else if (fromUnit === "K" && toUnit === "K") {
                result = inputValue + "K";
            }

            document.getElementById("display").value = result;
            speakResult(result);
        }
// BODMAS USES
document.addEventListener("keydown", function(event) {
    const key = event.key;
    const display = document.getElementById("display");

    // Numbers (0-9) aur operators (+, -, *, /, (, ))
    if (/[\d+\-*/().]/.test(key)) {
        display.value += key;
    }

    // Enter key se calculation hoga
    if (key === "Enter") {
        event.preventDefault(); 
        calculate();
    }

    // Backspace se last character delete hoga
    if (key === "Backspace") {
        display.value = display.value.slice(0, -1);
    }

    // Escape key dabane se screen clear hoga
    if (key === "Escape") {
        clearDisplay();
    }
});


document.addEventListener("keydown", function(event) {
    const key = event.key;
    const display = document.getElementById("display");

    // Numbers & basic operators
    if (/[\d+\-*/().]/.test(key)) {
        display.value += key;
    }

    // Enter key = Calculate
    if (key === "Enter") {
        event.preventDefault();
        calculate();
    }

    // Backspace = Delete last character
    if (key === "Backspace") {
        display.value = display.value.slice(0, -1);
    }

    // Escape = Clear screen
    if (key === "Escape") {
        clearDisplay();
    }

    //  scientific functions
    const functions = {
        s: "sin(",   
        c: "cos(",   
        t: "tan(",   
        l: "log(",   
        r: "sqrt(", 
        "!": "!",   
        "^": "^"     
    };

    if (functions[key]) {
        display.value += functions[key];
    }
});


//  BP checkup

async function startBPPulseDetection() {
            const video = document.getElementById("webcam");
            const bpResult = document.getElementById("bpResult");

            try {
                const stream = await navigator.mediaDevices.getUserMedia({ video: true });
                video.srcObject = stream;

                // Simulated BP & Pulse Calculation (Ek hi baar)
                setTimeout(() => {
                    let pulseRate = Math.floor(70 + Math.random() * 30); // Simulated Pulse Rate (70-100 BPM)
                    let systolic = Math.round((pulseRate * 0.6) + 90);
                    let diastolic = Math.round(systolic * 0.65);

                    let status = " Normal BP";
                    if (systolic < 90 || diastolic < 60) {
                        status = " Low BP (Hypotension)";
                    } else if (systolic > 140 || diastolic > 90) {
                        status = " High BP (Hypertension)";
                    }

                    bpResult.innerHTML = ` Pulse Rate: <b>${pulseRate} BPM</b> <br>  BP: <b>${systolic}/${diastolic} mmHg</b> <br> Status: <b>${status}</b>`;
                }, 3000); // 3 seconds ke baad ek hi baar detect karega

            } catch (error) {
                bpResult.innerHTML = " Webcam Access Denied!";
            }
        }

    </script>
</body>
</html>
